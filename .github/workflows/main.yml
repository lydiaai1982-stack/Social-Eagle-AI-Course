name: Send Webhook on Failure

on:
  push:
    branches:
      - '**'

jobs:
  do-something:
    runs-on: ubuntu-latest
    steps:
      - name: Example step (replace with real steps)
        run: exit 1   # simulate failure for testing

  send-webhook-on-failure:
    runs-on: ubuntu-latest
    needs: do-something
    if: failure()   # only run if previous job failed
    steps:
      - name: Send webhook to n8n on failure
        run: |
          curl -X POST \
            -H "Content-Type: application/json" \
            -d "{\"status\": \"failed\", \"repository\": \"${{ github.repository }}\", \"commit\": \"${{ github.sha }}\", \"actor\": \"${{ github.actor }}\"}" \
            https://n8n.srv1073770.hstgr.cloud/webhook/github-issue

